-- Drop the existing constraint if it exists (might be named differently, so we try to be generic or just add if missing)
-- Note: You might need to check the actual constraint name in your DB. 
-- Usually it is bookings_status_check.

DO $$
BEGIN
    IF EXISTS (SELECT 1 FROM pg_constraint WHERE conname = 'bookings_status_check') THEN
        ALTER TABLE bookings DROP CONSTRAINT bookings_status_check;
    END IF;
END $$;

-- Add the new constraint including 'failed'
ALTER TABLE bookings ADD CONSTRAINT bookings_status_check 
CHECK (status IN ('pending', 'confirmed', 'cancelled', 'completed', 'failed'));
